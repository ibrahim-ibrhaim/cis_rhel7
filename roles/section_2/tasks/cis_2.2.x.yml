---

- name: "2.2.2 Ensure X11 Server components are not installed"
  package:
      state: absent
      name:
          - "@X Window System"
          - "xorg-x11*"
  when:
      - rhel7cis_rule_2_2_2

- name: "2.2.3 Ensure Avahi Server is not installed"
  service:
      name: avahi-daemon
      state: stopped
      enabled: no
  when:
      - rhel7cis_rule_2_2_3

- name: "2.2.4 Ensure CUPS is not installed"
  package:
      name: cups
      state: absent
  when:
      - rhel7cis_rule_2_2_4

- name: "2.2.5 Ensure DHCP Server is not installed"
  package:
      name: dhcp
      state: absent
  when:
      - rhel7cis_rule_2_2_5

- name: "2.2.6 Ensure LDAP server is not installed"
  package:
      name: openldap-servers
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_6

- name: "2.2.7 Ensure DNS server is not installed"
  package:
      name: bind
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_7

- name: "2.2.8 Ensure FTP server is not installed"
  package:
      name: vsftpd
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_8

- name: "2.2.9 Ensure HTTP server is not installed"
  package:
      name: httpd
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_9

- name: "2.2.10 Ensure IMAP and POP3 server is not installed"
  package:
      name: dovecot
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_10

- name: "2.2.11 Ensure Samba server is not installed"
  package:
      name: samba
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_11

- name: "2.2.12 Ensure HTTP Proxy server is not installed"
  package:
      name: squid
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_12

- name: "2.2.13 Ensure net-snmp is not installed"
  package:
      name: net-snmp
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_13

- name: "2.2.14 Ensure NIS server is not installed"
  package:
      name: ypserv
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_14

- name: "2.2.15 Ensure telnet-server is not installed"
  package:
      name: telnet-server
      state: absent
  vars:
      ansible_python_interpreter: /bin/python
  when:
      - rhel7cis_rule_2_2_15

- name: "2.2.16 Ensure mail transfer agent is configured for local-only mode"
  lineinfile:
      dest: /etc/postfix/main.cf
      regexp: "^(#)?inet_interfaces"
      line: "inet_interfaces = loopback-only"
  notify: restart postfix
  when:
      - rhel7cis_rule_2_2_16

